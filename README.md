Original implemenation here:
https://stackoverflow.com/a/75179996/2041765
